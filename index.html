<!doctype html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <Title>RaamatuSild</Title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
</head>
<body>
  <header>

    <button type="button" class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#createBookModal">
      Add New Book
    </button>
  

    <div id="createBookModal" class="modal" tabindex="-1">
      <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <div class="h3">Create New Book</div>
          </div>
    
          <div class="modal-body">
            <!-- Form for creating a new book -->
            <form @submit.prevent="createBook" id="newBookForm">
              <div>
                <label for="newBookTitle" class="form-label">Title:</label>
                <input type="text" class="form-control" id="newBookTitle" v-model="newBookForm.title" required>
              </div>
              <div>
                <label for="newBookAuthor" class="form-label">Author:</label>
                <input type="text" class="form-control" id="newBookAuthor" v-model="newBookForm.author" required>
              </div>
              <div>
                <label for="newBookYear" class="form-label">Year:</label>
                <input type="number" class="form-control" id="newBookYear" v-model="newBookForm.year" required>
              </div>
              <div>
                <label for="newBookPages" class="form-label">Pages:</label>
                <input type="number" class="form-control" id="newBookPages" v-model="newBookForm.pages" required>
              </div>
              <br>
              <button type="submit" class="btn btn-success" id="createBookButton">Create</button>
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            </form>
          </div>

        </div>
      </div>
    </div>
    
  </header>

  <div id="app" style="width: 80%; margin: 10%;">
    <div>
      Books
    </div>
      <table id="booksTable" class="table table-striped table-bordered">
          <tr>
              <th>Title</th>
              <th>Author</th>
              <th>Year</th>
              <th>Pages</th>
          </tr>
          <tr v-for="book in books">
              <td @click="getBook(book.id)">{{ book.title }}</td>
              <td>{{ book.author }}</td>
              <td>{{ book.year }}</td>
              <td>{{ book.pages }}</td>
          </tr>
      </table>

      <div id="bookInfoModal" class="modal" tabindex="-1">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                  <table class="table table-striped">
                      <tr><th>ID</th> <td>{{bookInModal.id}}</td></tr>
                      <tr><th>Title</th> <td>{{bookInModal.title}}</td></tr>
                      <tr><th>Author</th> <td>{{bookInModal.author}}</td></tr>
                      <tr><th>Year</th> <td>{{bookInModal.year}}</td></tr>
                      <tr><th>Pages</th> <td>{{bookInModal.pages}}</td></tr>
                  </table>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-dark" data-bs-target="#updateBookModal" data-bs-dismiss="modal">Update</button>
                <button type="button" class="btn btn-danger" @click="deleteBook(bookInModal.id)" data-bs-dismiss="modal">Delete</button>
              </div>
            </div>
          </div>
        </div>

        <div id="updateBookModal" class="modal" tabindex="-1">
          <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content text-center">
              <div class="modal-header text-center">
                <div class="h3">Update Book</div>
              </div>
              <div class="modal-body">
                <form @submit.prevent="updateBook(bookInModal.id)" id="updateBookForm">
                  <div>
                    <label for="updateBookTitle" class="form-label">Title:</label>
                    <input type="text" class="form-control" id="updateBookTitle" v-model="bookInModal.title" required>
                  </div>
                  <div>
                    <label for="updateBookAuthor" class="form-label">Author:</label>
                    <input type="text" class="form-control" id="updateBookAuthor" v-model="bookInModal.author" required>
                  </div>
                  <div>
                    <label for="updateBookYear" class="form-label">Year:</label>
                    <input type="number" class="form-control" id="updateBookYear" v-model="bookInModal.year" required>
                  </div>
                  <div>
                    <label for="updateBookPages" class="form-label">Pages:</label>
                    <input type="number" class="form-control" id="updateBookPages" v-model="bookInModal.pages" required>
                  </div>
                  <br>
                  <button type="submit" class="btn btn-success" id="updateBookButton">Update</button>
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                </form>
              </div>
            </div>
          </div>
        </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js" 
  integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+" crossorigin="anonymous"></script>
  <script src="https://unpkg.com/vue@3.2.47/dist/vue.global.js"></script>
  <script src="rest-client.js?v=<?= time() ?>"></script>

  <!-- <script>
    $(document).ready(function() {
        $('#createBookButton').click(function() {
            var form = $('#newBookForm')[0]; // Get the form element
            var formData = new FormData(form);

            $.ajax({
                type: 'POST',
                url: 'http://localhost:8080/books', // Update the URL
                data: formData,
                contentType: false,
                processData: false,
                success: function(response) {
                    console.log('New book created:', response);
                    // Handle success, e.g., update UI, show a message, etc.
                    $('#createBookModal').modal('hide'); // Close the modal
                },
                error: function(error) {
                    console.error('Error creating new book:', error);
                    // Handle error, e.g., show an error message
                }
            });
        });
    });
  </script> -->
        
</body>
</html>